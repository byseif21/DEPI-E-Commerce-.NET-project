@{
    // Only show one type of error message to prevent duplicates
    bool showViewBagError = !string.IsNullOrEmpty(ViewBag.ErrorMessage);
    bool showModelStateError = ViewData.ModelState.ErrorCount > 0 && !showViewBagError;
}

@if (showViewBagError)
{
    <div class="alert alert-danger mb-3">
        <i class="fas fa-exclamation-circle me-2"></i>@ViewBag.ErrorMessage
        
        @if (ViewBag.ValidationErrors != null && ViewBag.ValidationErrors.Count > 0)
        {
            <ul class="mt-2 mb-0">
                @foreach (var error in ViewBag.ValidationErrors)
                {
                    <li>@error</li>
                }
            </ul>
        }
    </div>
}

@if (showModelStateError)
{
    <div class="alert alert-danger mb-3">
        <i class="fas fa-exclamation-circle me-2"></i>Please correct the following errors:
        <ul class="mt-2 mb-0">
            @foreach (var modelState in ViewData.ModelState.Values)
            {
                foreach (var error in modelState.Errors)
                {
                    <li>@error.ErrorMessage</li>
                }
            }
        </ul>
    </div>
}